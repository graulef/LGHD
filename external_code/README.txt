This code belongs to Peter kovesi
http://www.peterkovesi.com/matlabfns/index.html